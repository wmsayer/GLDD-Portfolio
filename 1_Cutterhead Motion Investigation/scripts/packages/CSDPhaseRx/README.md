# CSDPhaseRecognition
## Introduction
The goal of this project is to develop a neural network to itemize raw CSD data into CSD phases, series, blocks, and cuts as described below.

## Current State of Work
The current workflow is load .mdb into "mainPlotHistStats.py" and run. It will loop through all loaded files and process them through "RecognizePhase.py", plots a histogram of the step distribution and calculates step statistics in "AggregateStats.py", and then exports a .csv of the .mdb data with assigned CSD phases into the output directory. 

"RecognizePhase.py" asssigns CSDPhase to .mdb data with assistance from DelayTracker time entires. Currently the DelayTracker time entries are manual inputs, but on the TODO is to have them read from the DelayTracker database. Top/Bottom pass classification is a manual entry at the time, but can be determined automatically in the future through "blocks" as described below.

"mainBuildTrainingSet.py" is still in the works, but it manufactures a training set for the neural network by selecting and pre-processing input features and then assigning them a CSDPhase decision determined from running "RecognizePhase.py"

## Project Goal
The first milestone is to create a Bi-Directional LSTM that will determine CSD Phase based on feature inputs. The networks will be dredge-specific. Training set size will need to be determined through iterative trials and 80/20 cross-verification. Feature selection and pre-processing will also be an iterative process, but will be consistent across all CSD dredges.

Once CSD Phase is being recognized by the NN, additional networks or ML algorithms can be used to classify the remaining items.

## Classification Items and Relationships

#### Borrow Area
  - Defined by user (borrow area name, coordinates, grade, etc.)

#### Cuts
  - Defined by user for now by boundaries and centerline (CL)
  - Can later be defined with AI by absolute CL equation **Y = mX + b** and *aggregation of digging blocks*

#### Blocks
  - A block is an arbitrary contiguous area of digging. The boundaries of a block are defined by the coordinates of its first swing, last swing, port corners, and stbd corners
  - Blocks can also have an absolute CL equation that can help AI designate blocks to cuts in the future. CL equation comes from linear regression of each swing’s centroid.
  - A new block is generated by one of three triggers:
      1)	If the current block enters or leaves a previous block’s boundaries with a similar CL equation, then a new block is created (basically this separates 1st, 2nd, 3rd passes)
      2)	If there is an extended stoppage in time/delay then a new block is created (>10 min, or can even do it for every delay)
      3)	If there is an abnormally large dislocation (i.e. step size > 15ft) or large change in CL equation

#### Series
(I wanted to call this a "Set" but that is already taken in CSD dredging...maybe can find a better name)
  - A series is a group of swings where only one swing in the group is a standard swing (aka non-cleanup swing)
  - Every time there is a new standard swing a new series is generated
  - The purpose of the series is to account for double/triple swinging. It is key in order to keep our area and face calculations within the realms of reality.
  - For example, if you double swing and your step size is calculated as 0.1ft, your swing area will be extremely small, but you are still getting material in your density and velocity readings, so your calculated face for this swing is astronomically high. However if you group the 0.1ft swing with the previous swing that happened to be 6ft, then your face calculation for both will be based on 6.1ft. This is a realistic adjustment to make since your cleanup swing is digging the spillage from the previous standard swing.

#### Cleanup Swings & Standard Swings
- A cleanup swing is any swing with a step < 1.5 ft (this value was defined by *15857 Townsends Inlet Face Investigation* (not included), but is not set in stone, it may even be equipment-specific)
- A standard swing is any swing >= 1.5ft

#### CSD Phase
Every time stamp in the CutterRecord table gets allocated to a phase:
 - 1 - Port Swing
 - 2 - Stbd Swing
 - 3 - Port Corner
 - 4 - Stbd Corner
 - 5 - Delay
